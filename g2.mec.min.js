/**
 * g2.mec (c) 2013-16 Stefan Goessner
 * @file mechanical extensions to `g2`.
 * @author Stefan Goessner
 * @license MIT License
 */
var g2=g2||{prototype:{}};g2.prototype.mark=function t(o,r,n){var l=this.findCmdIdx(function(t){return"len"in t&&"p"in t});if(o&&l!==false){var e=this.cmds[l],s={},i,a=e.loc?e.loc([].concat(r)):[].concat(r);for(var c=0;c<a.length&&!s.done;c++){s=e.p(a[c]);i=n<0?Math.atan2(-s.dy,-s.dx):n>0?Math.atan2(s.dy,s.dx):0;this.use(o,{x:s.x,y:s.y,w:i,scl:1,ls:e.style&&e.style.ls||"@ls",fs:"@ls"})}}return this};g2.prototype.label=function o(t,r,n){var l=this.findCmdIdx(function(t){return"p"in t});if(l!==false){r=r==="mid"?.5:r;var e=this.cmds[l],i=e.p(e.loc?e.loc(r):r),a=n+0===n?n||1:r==="c"?0:(n==="left"?-1:1)*this.state.get("labelOffset"),c=i.dy*a,y=-i.dx*a;i.x+=c;i.y+=y;if(t[0]==="@"&&(s=e[t.substr(1)]))t=""+Number(s).toFixed(Math.max(g2.State.labelSignificantDigits-Math.log10(s),0))+(t.substr(1)==="angle"?"Â°":"");return this.txt(t,i.x,i.y,0,{thal:c>0?"left":c<0?"right":"center",tval:this.state.cartesian?y>0?"bottom":y<0?"top":"middle":y<0?"bottom":y>0?"top":"middle"})}return this};g2.prototype.vec=function r(t,o,n){var l=t&&t.x||0,e=typeof o==="object"?"x"in o?o.x:"dx"in o?l+o.dx:"r"in o?l+o.r*Math.cos(o.w||0):0:l+10,s=t&&t.y||0,i=typeof o==="object"?"y"in o?o.y:"dy"in o?s+o.dy:"r"in o?s+o.r*Math.sin(o.w||0):0:s,a,c,y=e-l,h=i-s,p=Math.hypot(y,h),u=p>0?y/p:0,d=p>0?h/p:0,f=Object.assign({},n,{fs:"@ls",lc:"round",lj:"round"});if(p>12)this.p().m(l,s).l(a=e,c=i).m(a,c).l(a+=-12*u-2.5*d,c+=-12*d+2.5*u).a(-Math.PI/3,a+5*d,c-5*u).z().drw(f);else this.lin(l,s,e,i,f);return this.proxy(g2.prototype.lin,[l,s,e,i])};g2.prototype.avec=function n(t,o,r,l,e){r=r||0;l=l||Math.PI/2;var s=t.x||0,i=t.y||0,a=l>=0?-12/o:12/o,c=Math.cos(r+l+a),y=Math.sin(r+l+a);return this.beg(Object.assign({ls:"@nodcolor",lw:1},e,{fs:"@ls",lc:"round",lj:"round"})).arc(s,i,o,r,l,{fs:"transparent"}).p().m(s+o*Math.cos(r+l),i+o*Math.sin(r+l)).l(s+(o-2.5)*c,i+(o-2.5)*y).a(Math.PI/3,s+(o+2.5)*c,i+(o+2.5)*y).z().drw().end().proxy(g2.prototype.arc,[s,i,o,r,l])};g2.prototype.dim=function l(t,o,r){var n=t&&t.x||0,l=typeof o==="object"?"x"in o?o.x:"dx"in o?n+o.dx:"r"in o?n+o.r*Math.cos(o.w||0):0:n+10,e=t&&t.y||0,s=typeof o==="object"?"y"in o?o.y:"dy"in o?e+o.dy:"r"in o?e+o.r*Math.sin(o.w||0):0:e,i,a,c=l-n,y=s-e,h=Math.hypot(c,y),p=r&&r.pos==="out"?-1:1,u=p*(h>0?c/h:0),d=p*(h>0?y/h:0);return this.p().m(n,e).l(l,s).m(i=n,a=e).l(i+=12*u-2.5*d,a+=12*d+2.5*u).a(Math.PI/3,i+=5*d,a+=-5*u).z().m(n+3*d,e-3*u).l(n-3*d,e+3*u).z().m(i=l,a=s).l(i+=-12*u-2.5*d,a+=-12*d+2.5*u).a(-Math.PI/3,i+=5*d,a+=-5*u).z().m(l+3*d,s-3*u).l(l-3*d,s+3*u).z().drw(Object.assign({ls:"@dimcolor"},r,{fs:"@ls",lc:"round",lj:"round"})).proxy(g2.prototype.lin,[n,e,l,s])};g2.prototype.adim=function e(t,o,r,n,l){r=r||0;n=n||Math.PI/2;var e=t.x||0,s=t.y||0,i=l&&l.pos==="out"?-1:1,a=i*(n>=0?12/o:-12/o),c=o-2.5,y=o+2.5,h=Math.cos(r),p=Math.sin(r),u=Math.cos(r+n),d=Math.sin(r+n),f=Math.cos(r+a),x=Math.sin(r+a),g=Math.cos(r+n-a),b=Math.sin(r+n-a);return this.beg(Object.assign({},l,{fs:"@ls",lc:"round",lj:"round"})).arc(e,s,o,r,n,{fs:"transparent"}).p().m(e+o*h,s+o*p).l(e+c*f,s+c*x).a(i*Math.PI/3,e+y*f,s+y*x).z().m(e+c*h,s+c*p).l(e+y*h,s+y*p).m(e+o*u,s+o*d).l(e+c*g,s+c*b).a(-i*Math.PI/3,e+y*g,s+y*b).z().m(e+c*u,s+c*d).l(e+y*u,s+y*d).drw().end().proxy(g2.prototype.arc,[e,s,o,r,n])};g2.prototype.slider=function i(t,o,r){var n=t.x||0,l=t.y||0,e=r&&r.b||32,s=r&&r.h||16;return this.beg(Object.assign({x:n,y:l,w:o||0,ls:"@nodcolor",fs:"@linkfill",lw:1},r,{lj:"round"})).rec(-e/2,-s/2,e,s).end().proxy(g2.prototype.rec,[n,l,e,s,r])};g2.prototype.spring=function a(t,o,r){var n=t&&t.x||0,l=typeof o==="object"?"x"in o?o.x:"dx"in o?n+o.dx:"r"in o?n+o.r*Math.cos(o.w||0):0:n+10,e=t&&t.y||0,s=typeof o==="object"?"y"in o?o.y:"dy"in o?e+o.dy:"r"in o?e+o.r*Math.sin(o.w||0):0:e,i=Math.hypot(l-n,s-e),a=r&&r.h||16;if(i<=a)return this.lin(n,e,l,s,{ls:"@nodcolor"},r,{lc:"round",lj:"round"});else{var c={x1:n,y1:e,x2:l,y2:s,ux:(l-n)/i,uy:(s-e)/i},y=(n+l)/2,h=(e+s)/2;return this.p().m(c.x1,c.y1).l(y-c.ux*a/2,h-c.uy*a/2).l(y+(-c.ux/6+c.uy/2)*a,h+(-c.uy/6-c.ux/2)*a).l(y+(c.ux/6-c.uy/2)*a,h+(c.uy/6+c.ux/2)*a).l(y+c.ux*a/2,h+c.uy*a/2).l(c.x2,c.y2).stroke(Object.assign({ls:"@nodcolor"},r,{fs:"transparent",lc:"round",lj:"round"})).proxy(g2.prototype.lin,[n,e,l,s,r])}};g2.prototype.damper=function(t,o,r){var n=t&&t.x||0,l=typeof o==="object"?"x"in o?o.x:"dx"in o?n+o.dx:"r"in o?n+o.r*Math.cos(o.w||0):0:n+10,e=t&&t.y||0,s=typeof o==="object"?"y"in o?o.y:"dy"in o?e+o.dy:"r"in o?e+o.r*Math.sin(o.w||0):0:e,i=Math.hypot(l-n,s-e),a=r&&r.h||16;if(i<=a)return this.lin(n,e,l,s,{ls:"@nodcolor"},r,{lc:"round",lj:"round"});else{var c={x1:n,y1:e,x2:l,y2:s,ux:(l-n)/i,uy:(s-e)/i},y=(n+l)/2,h=(e+s)/2;return this.p().m(c.x1,c.y1).l(y-c.ux*a/2,h-c.uy*a/2).m(y+(c.ux-c.uy)*a/2,h+(c.uy+c.ux)*a/2).l(y+(-c.ux-c.uy)*a/2,h+(-c.uy+c.ux)*a/2).l(y+(-c.ux+c.uy)*a/2,h+(-c.uy-c.ux)*a/2).l(y+(c.ux+c.uy)*a/2,h+(c.uy-c.ux)*a/2).m(y,h).l(c.x2,c.y2).stroke(Object.assign({ls:"@nodcolor"},r,{fs:"transparent",lc:"round",lj:"round"})).proxy(g2.prototype.lin,[n,e,l,s,r])}};g2.prototype.link=function c(t,o){return this.ply(t,o,{fs:o===true?"@linkfill":"transparent",ls:"@linkcolor",lw:5,lc:"round",lj:"round"}).proxy(g2.prototype.ply,[t])};g2.prototype.link2=function y(t,o,r){return this.cpy(o===true?this.ply(t,o,{ls:"transparent",fs:"@linkfill",lw:7,lc:"round",lj:"round"}):this).ply(t,o,{ls:"@nodcolor",lw:7,lc:"round",lj:"round",fs:"transparent"}).ply(t,o,{ls:"@nodfill2",lw:4.5,lc:"round",lj:"round",fs:"transparent"}).ply(t,o,{ls:"@nodfill",lw:2,lc:"round",lj:"round",fs:"transparent"}).proxy(g2.prototype.ply,[t])};g2.prototype.beam=function h(t,o){return this.ply(t,o,{fs:"transparent",ls:"@linkcolor",lw:5,lc:"butt",lj:"round"}).proxy(g2.prototype.ply,[t])};g2.prototype.beam2=function p(t,o,r){return this.ply(t,o,{ls:"@nodcolor",lw:7,lc:"butt",lj:"round",fs:"transparent"}).ply(t,o,{ls:"@nodfill2",lw:4.5,lc:"butt",lj:"round",fs:"transparent"}).ply(t,o,{ls:"@nodfill",lw:2,lc:"butt",lj:"round",fs:"transparent"}).proxy(g2.prototype.ply,[t])};g2.prototype.bar=function u(t,o){var r=t&&t.x||0,n=typeof o==="object"?"x"in o?o.x:"dx"in o?r+o.dx:"r"in o?r+o.r*Math.cos(o.w||0):0:r+10,l=t&&t.y||0,e=typeof o==="object"?"y"in o?o.y:"dy"in o?l+o.dy:"r"in o?l+o.r*Math.sin(o.w||0):0:l;return this.lin(r,l,n,e,{ls:"@linkcolor",lw:6,lc:"round"}).proxy(g2.prototype.lin,[r,l,n,e])};g2.prototype.bar2=function d(t,o){var r=t&&t.x||0,n=typeof o==="object"?"x"in o?o.x:"dx"in o?r+o.dx:"r"in o?r+o.r*Math.cos(o.w||0):0:r+10,l=t&&t.y||0,e=typeof o==="object"?"y"in o?o.y:"dy"in o?l+o.dy:"r"in o?l+o.r*Math.sin(o.w||0):0:l;return this.lin(r,l,n,e,{ls:"@nodcolor",lw:7,lc:"round"}).lin(r,l,n,e,{ls:"@nodfill2",lw:4.5,lc:"round"}).lin(r,l,n,e,{ls:"@nodfill",lw:2,lc:"round"}).proxy(g2.prototype.lin,[r,l,n,e])};g2.prototype.pulley=function f(t,o){o=o||25;return this.cir(t.x,t.y,o,{ls:"@nodcolor",fs:"#e6e6e6",lw:1}).cir(t.x,t.y,o-5,{ls:"@nodcolor",fs:"#e6e6e6",lw:1}).cir(t.x,t.y,o-6,{ls:"#8e8e8e",fs:"transparent",lw:2}).cir(t.x,t.y,o-8,{ls:"#aeaeae",fs:"transparent",lw:2}).cir(t.x,t.y,o-10,{ls:"#cecece",fs:"transparent",lw:2}).proxy(g2.prototype.cir,[t.x,t.y,o])};g2.prototype.pulley2=function x(t,o){o=o||25;return this.beg(t).bar2({x:0,y:o-4},{x:0,y:-o+4}).bar2({x:o-4,y:0},{x:-o+4,y:0}).cir(0,0,o-2.5,{ls:"#e6e6e6",fs:"transparent",lw:5}).cir(0,0,o,{ls:"@nodcolor",fs:"transparent",lw:1}).cir(0,0,o-5,{ls:"@nodcolor",fs:"transparent",lw:1}).end().proxy(g2.prototype.cir,[t.x,t.y,o])};g2.prototype.rope=function g(t,o,r,n){var l=10,e=o>l?o-2.5:o<-l?o+2.5:0,s=n>l?n-2.5:n<-l?n+2.5:0,i=r.x-t.x,a=r.y-t.y,c=i*i+a*a,y=e+s,h=Math.sqrt(c-y*y),p=(y*i+h*a)/c,u=(y*a-h*i)/c,d=t.x+p*e,f=t.y+u*e,x=r.x-p*s,g=r.y-u*s;return this.lin(d,f,x,g,{ls:"#888",lw:5}).proxy(g2.prototype.lin,[d,f,x,g])};g2.prototype.ground=function b(t,o,r){var n=0,l,e,s,i,a,c,y,h,p,u,d,f=[],x=r&&r.h||4,g=r&&r.pos==="left"?1:-1,b=g2.prototype.ply.itrOf(t,r);l=e=b(t,n=0);f.push(l);i=b(t,n=1);c=i.x-e.x;y=i.y-e.y;u=Math.hypot(c,y)||1;a=h={x:c/u,y:y/u};for(s=b(t,++n);!s.done;s=b(t,++n)){c=s.x-i.x;y=s.y-i.y;u=Math.hypot(c,y)||1;p={x:c/u,y:y/u};d=(1-p.x*h.x-p.y*h.y)/(h.y*p.x-h.x*p.y);f.push({x:i.x+g*(x+1)*(d*h.x-h.y),y:i.y+g*(x+1)*(d*h.y+h.x)});h=p;e=i;i=s}if(o){c=l.x-i.x;y=l.y-i.y;u=Math.hypot(c,y)||1;p={x:c/u,y:y/u};d=(1-p.x*h.x-p.y*h.y)/(h.y*p.x-h.x*p.y);f.push({x:i.x+g*(x+1)*(d*h.x-h.y),y:i.y+g*(x+1)*(d*h.y+h.x)});d=(1-a.x*p.x-a.y*p.y)/(p.y*a.x-p.x*a.y);f[0]={x:l.x+g*(x+1)*(-d*a.x-a.y),y:l.y+g*(x+1)*(-d*a.y+a.x)}}else{f[0]={x:l.x-g*(x+1)*a.y,y:l.y+g*(x+1)*a.x};f.push({x:i.x-g*(x+1)*h.y,y:i.y+g*(x+1)*h.x})}return this.beg(Object.assign({x:-.5,y:-.5,ls:"@linkcolor",fs:"transparent",lw:2},r,{fs:"transparent",lc:"butt",lj:"miter"})).ply(t,o,r).ply(f,o,{ls:"@nodfill2",lw:2*x}).end()};g2.State=g2.State||{};g2.State.nodcolor="#333";g2.State.nodfill="#dedede";g2.State.nodfill2="#aeaeae";g2.State.linkcolor="#666";g2.State.linkfill="rgba(200,200,200,0.5)";g2.State.dimcolor="darkslategray";g2.State.solid=[];g2.State.dash=[15,10];g2.State.dot=[4,4];g2.State.dashdot=[25,6.5,2,6.5];g2.State.labelOffset=5;g2.State.labelSignificantDigits=3;g2.symbol=g2.symbol||{};g2.symbol.origin=function(){var t=3.5;return g2().beg({lc:"round",lj:"round",lw:1,fs:"@nodfill"}).p().m(6*t,0).l(0,0).l(0,6*t).stroke().p().m(10*t,0).l(6*t,3/4*t).a(-Math.PI/3,6*t,-3/4*t).z().m(0,10*t).l(3/4*t,6*t).a(Math.PI/3,-3/4*t,6*t).z().drw().cir(0,0,t).end()}();g2.symbol.nod=g2().cir(0,0,5,{ls:"@nodcolor",fs:"@nodfill",lwnosc:true});g2.symbol.dblnod=g2().cir(0,0,6,{ls:"@nodcolor",fs:"@nodfill"}).cir(0,0,3,{ls:"@nodcolor",fs:"@nodfill2"});g2.symbol.nodfix=g2().style({ls:"@nodcolor",fs:"@nodfill",lwnosc:true}).p().m(-8,-12).l(0,0).l(8,-12).drw({fs:"@nodfill2"}).cir(0,0,5);g2.symbol.dblnodfix=g2().p().m(-8,-12).l(0,0).l(8,-12).drw({ls:"@nodcolor",fs:"@nodfill2"}).cir(0,0,6,{ls:"@nodcolor",fs:"@nodfill"}).cir(0,0,3,{ls:"@nodcolor",fs:"@nodfill2"});g2.symbol.nodflt=g2().style({ls:"@nodcolor",fs:"@nodfill",lwnosc:true}).p().m(-8,-12).l(0,0).l(8,-12).z().drw({fs:"@nodfill2"}).cir(0,0,5,{fs:"@nodfill"}).lin(-9,-19,9,-19,{ls:"@nodfill2",lw:5,lwnosc:false}).lin(-9,-15.5,9,-15.5,{ls:"@nodcolor",lw:2,lwnosc:false});g2.symbol.dblnodflt=g2().style({ls:"@nodcolor",fs:"@nodfill2",lwnosc:true}).p().m(-8,-12).l(0,0).l(8,-12).z().drw().cir(0,0,6,{fs:"@nodfill"}).cir(0,0,3).lin(-9,-19,9,-19,{ls:"@nodfill2",lw:5,lwnosc:false}).lin(-9,-15.5,9,-15.5,{lw:2,lwnosc:false});g2.symbol.gnd=g2().cir(0,0,6,{ls:"@nodcolor",fs:"@nodfill",lwnosc:true}).p().m(0,6).a(-Math.PI/2,6,0).l(-6,0).a(Math.PI/2,0,-6).z().fill({fs:"@nodcolor"});g2.symbol.pol=g2().cir(0,0,6,{ls:"@nodcolor",fs:"@nodfill",lwnosc:true}).cir(0,0,2.5,{ls:"@nodcolor",fs:"@nodcolor"});g2.symbol.ifo2pos=g2().style({ls:"@nodcolor",lc:"round",fs:"@ls"}).p().m(0,5).a(-Math.PI/2,0,0).a(Math.PI/2,0,-5).m(12,-12).a(Math.PI/2,12,12).stroke().p().m(6,12).l(6,-4).m(6,-12).l(8,-4).a(-Math.PI/3,4,-4).z().m(12,12).l(14,5).a(-Math.PI/3,17,7).z().drw();g2.symbol.ifo2neg=g2().style({ls:"@nodcolor",lc:"round",fs:"@ls"}).p().m(0,5).a(Math.PI/2,0,0).a(-Math.PI/2,0,-5).m(-12,-12).a(-Math.PI/2,-12,12).stroke().p().m(-6,-12).l(-6,4).m(-6,12).l(-8,4).a(Math.PI/3,-4,4).z().m(-12,12).l(-14,5).a(Math.PI/3,-17,7).z().drw();g2.symbol.ifo3pos=g2().style({ls:"@nodcolor",lc:"round",fs:"@ls"}).p().m(0,5).a(-Math.PI/2,0,0).a(Math.PI/2,0,-5).m(12,-12).a(Math.PI/2,12,12).stroke().p().m(6,12).l(6,-4).m(6,-12).l(8,-4).a(-Math.PI/3,4,-4).z().m(12,12).l(14,5).a(-Math.PI/3,17,7).z().m(8,0).l(20,0).m(28,0).l(20,-2).a(Math.PI/3,20,2).z().drw();g2.symbol.ifo3neg=g2().style({ls:"@nodcolor",lc:"round",fs:"@ls"}).p().m(0,5).a(Math.PI/2,0,0).a(-Math.PI/2,0,-5).m(-12,-12).a(-Math.PI/2,-12,12).stroke().p().m(-6,-12).l(-6,4).m(-6,12).l(-8,4).a(Math.PI/3,-4,4).z().m(-12,12).l(-14,5).a(Math.PI/3,-17,7).z().m(-8,0).l(-20,0).m(-28,0).l(-20,-2).a(-Math.PI/3,-20,2).z().drw();g2.symbol.dot=g2().cir(0,0,2,{fs:"@ls"});g2.symbol.sqr=g2().rec(-2,-2,4,4,{fs:"@ls"});g2.symbol.tilde=g2().p().m(0,4).a(Math.PI/2,0,0).a(-Math.PI/2,0,-4).stroke({lc:"round"});g2.symbol.arrow=g2().p().m(0,0).l(-7,-2).a(Math.PI/3,-7,2).z().drw({fs:"@ls",lj:"round"});g2.symbol.tick=g2().p().m(0,-3).l(0,3).stroke({lc:"round"});g2.symbol.arrowtick=g2().p().m(0,-3).l(0,3).m(0,0).l(-7,-2).a(Math.PI/3,-7,2).z().drw({lj:"round",lc:"round"});g2.prototype.lin.proto={get x1(){return this.a[0]},get y1(){return this.a[1]},get dx(){return this.a[2]-this.a[0]},get dy(){return this.a[3]-this.a[1]},get len(){return Math.hypot(this.dx,this.dy)},get style(){return this.a[4]},p:function(t){var o=t==="beg"?0:t==="end"?1:t+0===t?t:.5,r=this.g2.state.cartesian?this.len:-this.len;return{x:this.x1+this.dx*o,y:this.y1+this.dy*o,dx:this.dx/r,dy:this.dy/r}}};g2.prototype.rec.proto={dir:{c:[0,0,1],e:[1,0,1],ne:[1,-1,Math.SQRT2],n:[0,-1,1],nw:[-1,-1,Math.SQRT2],w:[-1,0,1],sw:[-1,1,Math.SQRT2],s:[0,1,1],se:[1,1,Math.SQRT2]},get x(){return this.a[0]},get y(){return this.a[1]},get b(){return this.a[2]},get h(){return this.a[3]},get len(){return 2*(this.b+this.h)},get style(){return this.a[4]},p:function(t){var o=this.dir[t||"c"]||this.dir["c"],r=o[0],n=this.g2.state.cartesian?-o[1]:o[1];return{x:this.x+(1+r)*this.b/2,y:this.y+(1+n)*this.h/2,dx:-n/o[2],dy:r/o[2]}}};g2.prototype.cir.proto={dir:{c:[0,0],e:[1,0],ne:[Math.SQRT2/2,Math.SQRT2/2],n:[0,1],nw:[-Math.SQRT2/2,Math.SQRT2/2],w:[-1,0],sw:[-Math.SQRT2/2,-Math.SQRT2/2],s:[0,-1],se:[Math.SQRT2/2,-Math.SQRT2/2]},get x(){return this.a[0]},get y(){return this.a[1]},get r(){return this.a[2]},get len(){return 2*Math.PI*this.r},get style(){return this.a[3]},p:function(t){var o=t+0===t?[Math.cos(t*2*Math.PI),Math.sin(t*2*Math.PI)]:this.dir[t||"c"],r=o[0],n=this.g2.state.cartesian?o[1]:-o[1];return{x:this.x+r*this.r,y:this.y+n*this.r,dx:-n,dy:r}}};g2.prototype.arc.proto={get x(){return this.a[0]},get y(){return this.a[1]},get r(){return this.a[2]},get w(){return this.a[3]},get dw(){return this.a[4]},get len(){return Math.abs(this.r*this.dw)},get angle(){return this.dw/Math.PI*180},get style(){return this.a[5]},p:function(t){var o=t==="beg"?0:t==="end"?1:t==="mid"?.5:t+0===t?t:.5,r=this.w+o*this.dw,n=Math.cos(r),l=Math.sin(r),e=t==="c"?0:this.r;return{x:this.x+e*n,y:this.y+e*l,dx:-l,dy:n}}};g2.prototype.ply.proto={get pts(){return this.a[0]},get itr(){return g2.prototype.ply.itrOf(this.a[0],this.a[2])},get n(){return this.count||(this.count=this.itr(this.pts).count)},get closed(){return this.a[1]===true},get len(){var t,o,r=this.itr,n=r(this.pts,0),l,e=this.n,s=this.closed,i=0;for(t=0,o=1;t<(s?e:e-1);t++,o=(t+1)%e){l=r(this.pts,o);i+=Math.hypot(l.x-n.x,l.y-n.y);n=l}return i},loc:function(t){function o(t,o){var r=[];for(var n=t;n<o;n++)r.push("#"+n);return r}for(var r=0;r<t.length;r++){if(t[r]==="beg")t[r]="#0";else if(t[r]==="end")t[r]="#"+Math.max(this.n-1,0);else if(t[r]==="mid")t=t.splice(r,1)&&t.concat(o(1,Math.max(1,this.n-1)));else if(t[r]==="all")t=t.splice(r,1)&&t.concat(o(0,Math.max(1,this.n)));else if(t===undefined)t[r]=.5}return t},p:function(t){if(typeof t==="string"&&t[0]==="#")return this.pIdx(+t.substr(1));else return this.pPar(t)},pIdx:function(t){var o=Math.max(t-1,0),r=Math.min(t+1,this.n-1),n=this.itr,l=n(this.pts,o),e=n(this.pts,t),s=n(this.pts,r),i=s.x-l.x,a=s.y-l.y,c=this.g2.state.cartesian?Math.hypot(i,a):-Math.hypot(i,a);return{x:e.x,y:e.y,dx:i/c,dy:a/c}},pPar:function(t){var o,r,n=this.itr,l=n(this.pts,0),e,s=this.n,i=this.len,a=this.closed,c=0,y,h,p,u,d,f=this.g2.state.cartesian?1:-1;if(i>0){t=Math.max(0,Math.min(1,t));u=t*i;for(o=0,r=1;o<=(a?s:s-1);o++,r=(o+1)%s){e=n(this.pts,r);y=e.x-l.x;h=e.y-l.y;p=Math.hypot(y,h);if(c+p>=u){d=(t-c/i)*i/p;return{x:l.x+d*y,y:l.y+d*h,dx:f*y/p,dy:f*h/p}}c+=p;l=e}}return n(this.pts,0)}};g2.prototype.use.proto={dir:g2.prototype.cir.proto.dir,get x(){return this.a[1].x},get y(){return this.a[1].y},get r(){return 5},p:g2.prototype.cir.proto.p};