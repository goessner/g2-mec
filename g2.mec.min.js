/**
 * g2.mec (c) 2013-16 Stefan Goessner
 * @file mechanical extensions to `g2`.
 * @author Stefan Goessner
 * @license MIT License
 */
var g2=g2||{prototype:{}};g2.prototype.skip=function t(o){if(this.cmds.length)this.cmds[this.cmds.length-1].skip=o;return this};g2.prototype.mark=function o(t,r,n){var e=this.findCmdIdx(function(t){return"len"in t.c.prototype&&"p"in t.c.prototype});obj=e>=0?this.cmds[e].c.create(this.cmds[e].a):null;if(t&&obj!==null){var l={},s,i=obj.locs?obj.locs([].concat(r)):[].concat(r);for(var a=0;a<i.length;a++){l=obj.p(i[a]);s=n<0?Math.atan2(-l.dy,-l.dx):n>0?Math.atan2(l.dy,l.dx):0;this.use(t,{x:l.x,y:l.y,w:s,scl:obj.style&&obj.style.lw||"@lwOwner",ls:obj.style&&obj.style.ls||"@ls",fs:"@ls"}).skip("label")}}return this};g2.prototype.label=function r(t,o,n){var e=this.findCmdIdx(function(t){return t.skip!=="label"&&"p"in t.c.prototype}),l;l=e!==false?this.cmds[e].c.create(this.cmds[e].a):null;if(l){var i=l.p(l.loc?l.loc(o):o),a=n+0===n?n||1:o==="c"?0:this.state.get("labelOffset"),y,c;if(n!=="left")a=-a;y=-i.dy*a;c=i.dx*a;i.x+=y;i.y+=c;if(t[0]==="@"&&(s=l[t.substr(1)]))t=""+(Number.isInteger(+s)?+s:Number(s).toFixed(Math.max(g2.State.labelSignificantDigits-Math.log10(s),0)))+(t.substr(1)==="angle"?"Â°":"");return this.txt(t,i.x,i.y,0,{thal:y>0?"left":y<0?"right":"center",tval:c>0?"bottom":c<0?"top":"middle"})}return this};g2.prototype.vec=function n(t,o,r){var n=t&&t.x||0,e=typeof o==="object"?"x"in o?o.x:"dx"in o?n+o.dx:"r"in o?n+o.r*Math.cos(o.w||0):0:n+10,l=t&&t.y||0,s=typeof o==="object"?"y"in o?o.y:"dy"in o?l+o.dy:"r"in o?l+o.r*Math.sin(o.w||0):0:l,i=Math.hypot(e-n,s-l);if(i>0)this.lin(n,l,e,s,r);if(i>12)this.mark("arrow","end",1);return this.proxy(g2.prototype.lin,[n,l,e,s,r])};g2.prototype.avec=function e(t,o,r,n,l){r=r||0;n=n||Math.PI/2;var s=t.x||0,i=t.y||0,a=n>=0?-12/o:12/o,y=Math.cos(r+n+a),c=Math.sin(r+n+a);return this.beg(Object.assign({ls:"@nodcolor",lw:1},l,{fs:"@ls",lc:"round",lj:"round"})).arc(s,i,o,r,n,{fs:"transparent"}).p().m(s+o*Math.cos(r+n),i+o*Math.sin(r+n)).l(s+(o-2.5)*y,i+(o-2.5)*c).a(Math.PI/3,s+(o+2.5)*y,i+(o+2.5)*c).z().drw().end().proxy(g2.prototype.arc,[s,i,o,r,n])};g2.prototype.dim=function l(t,o,r){var n=t&&t.x||0,e=typeof o==="object"?"x"in o?o.x:"dx"in o?n+o.dx:"r"in o?n+o.r*Math.cos(o.w||0):0:n+10,l=t&&t.y||0,s=typeof o==="object"?"y"in o?o.y:"dy"in o?l+o.dy:"r"in o?l+o.r*Math.sin(o.w||0):0:l,i,a,y=e-n,c=s-l,p=Math.hypot(y,c),u=r&&r.pos==="out"?-1:1,h=u*(p>0?y/p:0),d=u*(p>0?c/p:0);return this.p().m(n,l).l(e,s).m(i=n,a=l).l(i+=12*h-2.5*d,a+=12*d+2.5*h).a(Math.PI/3,i+=5*d,a+=-5*h).z().m(n+3*d,l-3*h).l(n-3*d,l+3*h).z().m(i=e,a=s).l(i+=-12*h-2.5*d,a+=-12*d+2.5*h).a(-Math.PI/3,i+=5*d,a+=-5*h).z().m(e+3*d,s-3*h).l(e-3*d,s+3*h).z().drw(Object.assign({ls:"@dimcolor"},r,{fs:"@ls",lc:"round",lj:"round"})).proxy(g2.prototype.lin,[n,l,e,s,r])};g2.prototype.adim=function i(t,o,r,n,e){r=r||0;n=n||Math.PI/2;var l=t.x||0,s=t.y||0,i=e&&e.pos==="out"?-1:1,a=i*(n>=0?12/o:-12/o),y=o-2.5,c=o+2.5,p=Math.cos(r),u=Math.sin(r),h=Math.cos(r+n),d=Math.sin(r+n),f=Math.cos(r+a),x=Math.sin(r+a),g=Math.cos(r+n-a),b=Math.sin(r+n-a);return this.beg(Object.assign({},e,{fs:"@ls",lc:"round",lj:"round"})).arc(l,s,o,r,n,{fs:"transparent"}).p().m(l+o*p,s+o*u).l(l+y*f,s+y*x).a(i*Math.PI/3,l+c*f,s+c*x).z().m(l+y*p,s+y*u).l(l+c*p,s+c*u).m(l+o*h,s+o*d).l(l+y*g,s+y*b).a(-i*Math.PI/3,l+c*g,s+c*b).z().m(l+y*h,s+y*d).l(l+c*h,s+c*d).drw().end().proxy(g2.prototype.arc,[l,s,o,r,n])};g2.prototype.slider=function a(t,o,r){var n=t.x||0,e=t.y||0,l=r&&r.b||32,s=r&&r.h||16;return this.beg(Object.assign({x:n,y:e,w:o||0,ls:"@nodcolor",fs:"@linkfill",lw:1},r,{lj:"round"})).rec(-l/2,-s/2,l,s).end().proxy(g2.prototype.rec,[n,e,l,s,r])};g2.prototype.spring=function y(t,o,r){var n=t&&t.x||0,e=typeof o==="object"?"x"in o?o.x:"dx"in o?n+o.dx:"r"in o?n+o.r*Math.cos(o.w||0):0:n+10,l=t&&t.y||0,s=typeof o==="object"?"y"in o?o.y:"dy"in o?l+o.dy:"r"in o?l+o.r*Math.sin(o.w||0):0:l,i=Math.hypot(e-n,s-l),a=r&&r.h||16;if(i<=a)return this.lin(n,l,e,s,{ls:"@nodcolor"},r,{lc:"round",lj:"round"});else{var y={x1:n,y1:l,x2:e,y2:s,ux:(e-n)/i,uy:(s-l)/i},c=(n+e)/2,p=(l+s)/2;return this.p().m(y.x1,y.y1).l(c-y.ux*a/2,p-y.uy*a/2).l(c+(-y.ux/6+y.uy/2)*a,p+(-y.uy/6-y.ux/2)*a).l(c+(y.ux/6-y.uy/2)*a,p+(y.uy/6+y.ux/2)*a).l(c+y.ux*a/2,p+y.uy*a/2).l(y.x2,y.y2).stroke(Object.assign({ls:"@nodcolor"},r,{fs:"transparent",lc:"round",lj:"round"})).proxy(g2.prototype.lin,[n,l,e,s,r])}};g2.prototype.damper=function(t,o,r){var n=t&&t.x||0,e=typeof o==="object"?"x"in o?o.x:"dx"in o?n+o.dx:"r"in o?n+o.r*Math.cos(o.w||0):0:n+10,l=t&&t.y||0,s=typeof o==="object"?"y"in o?o.y:"dy"in o?l+o.dy:"r"in o?l+o.r*Math.sin(o.w||0):0:l,i=Math.hypot(e-n,s-l),a=r&&r.h||16;if(i<=a)return this.lin(n,l,e,s,{ls:"@nodcolor"},r,{lc:"round",lj:"round"});else{var y={x1:n,y1:l,x2:e,y2:s,ux:(e-n)/i,uy:(s-l)/i},c=(n+e)/2,p=(l+s)/2;return this.p().m(y.x1,y.y1).l(c-y.ux*a/2,p-y.uy*a/2).m(c+(y.ux-y.uy)*a/2,p+(y.uy+y.ux)*a/2).l(c+(-y.ux-y.uy)*a/2,p+(-y.uy+y.ux)*a/2).l(c+(-y.ux+y.uy)*a/2,p+(-y.uy-y.ux)*a/2).l(c+(y.ux+y.uy)*a/2,p+(y.uy-y.ux)*a/2).m(c,p).l(y.x2,y.y2).stroke(Object.assign({ls:"@nodcolor"},r,{fs:"transparent",lc:"round",lj:"round"})).proxy(g2.prototype.lin,[n,l,e,s,r])}};g2.prototype.link=function c(t,o,r){return this.ply(t,o,Object.assign({fs:o===true?"@linkfill":"transparent",ls:"@linkcolor",lw:5,lc:"round",lj:"round"},r)).proxy(g2.prototype.ply,[t])};g2.prototype.link2=function p(t,o){return this.cpy(o===true?this.ply(t,o,{ls:"transparent",fs:"@linkfill",lw:7,lc:"round",lj:"round"}):this).ply(t,o,{ls:"@nodcolor",lw:7,lc:"round",lj:"round",fs:"transparent"}).ply(t,o,{ls:"@nodfill2",lw:4.5,lc:"round",lj:"round",fs:"transparent"}).ply(t,o,{ls:"@nodfill",lw:2,lc:"round",lj:"round",fs:"transparent"}).proxy(g2.prototype.ply,[t])};g2.prototype.beam=function u(t){return this.ply(t,false,{fs:"transparent",ls:"@linkcolor",lw:5,lc:"butt",lj:"round"}).proxy(g2.prototype.ply,[t,false,null,{lw:2}])};g2.prototype.beam2=function h(t){return this.ply(t,false,{ls:"@nodcolor",lw:7,lc:"butt",lj:"round",fs:"transparent"}).ply(t,false,{ls:"@nodfill2",lw:4.5,lc:"butt",lj:"round",fs:"transparent"}).ply(t,false,{ls:"@nodfill",lw:2,lc:"butt",lj:"round",fs:"transparent"}).proxy(g2.prototype.ply,[t,false,null,{lw:2}])};g2.prototype.bar=function d(t,o,r){var n=t&&t.x||0,e=typeof o==="object"?"x"in o?o.x:"dx"in o?n+o.dx:"r"in o?n+o.r*Math.cos(o.w||0):0:n+10,l=t&&t.y||0,s=typeof o==="object"?"y"in o?o.y:"dy"in o?l+o.dy:"r"in o?l+o.r*Math.sin(o.w||0):0:l;return this.lin(n,l,e,s,Object.assign({ls:"@linkcolor",lw:6,lc:"round"},r)).proxy(g2.prototype.lin,[n,l,e,s])};g2.prototype.bar2=function f(t,o){var r=t&&t.x||0,n=typeof o==="object"?"x"in o?o.x:"dx"in o?r+o.dx:"r"in o?r+o.r*Math.cos(o.w||0):0:r+10,e=t&&t.y||0,l=typeof o==="object"?"y"in o?o.y:"dy"in o?e+o.dy:"r"in o?e+o.r*Math.sin(o.w||0):0:e;return this.lin(r,e,n,l,{ls:"@nodcolor",lw:7,lc:"round"}).lin(r,e,n,l,{ls:"@nodfill2",lw:4.5,lc:"round"}).lin(r,e,n,l,{ls:"@nodfill",lw:2,lc:"round"}).proxy(g2.prototype.lin,[r,e,n,l])};g2.prototype.pulley=function x(t,o){o=o||25;return this.cir(t.x,t.y,o,{ls:"@nodcolor",fs:"#e6e6e6",lw:1}).cir(t.x,t.y,o-5,{ls:"@nodcolor",fs:"#e6e6e6",lw:1}).cir(t.x,t.y,o-6,{ls:"#8e8e8e",fs:"transparent",lw:2}).cir(t.x,t.y,o-8,{ls:"#aeaeae",fs:"transparent",lw:2}).cir(t.x,t.y,o-10,{ls:"#cecece",fs:"transparent",lw:2}).proxy(g2.prototype.cir,[t.x,t.y,o])};g2.prototype.pulley2=function g(t,o){o=o||25;return this.beg(t).bar2({x:0,y:o-4},{x:0,y:-o+4}).bar2({x:o-4,y:0},{x:-o+4,y:0}).cir(0,0,o-2.5,{ls:"#e6e6e6",fs:"transparent",lw:5}).cir(0,0,o,{ls:"@nodcolor",fs:"transparent",lw:1}).cir(0,0,o-5,{ls:"@nodcolor",fs:"transparent",lw:1}).end().proxy(g2.prototype.cir,[t.x,t.y,o])};g2.prototype.rope=function b(t,o,r,n,e){var l=10,s=o>l?o-2.5:o<-l?o+2.5:0,i=n>l?n-2.5:n<-l?n+2.5:0,a=r.x-t.x,y=r.y-t.y,c=a*a+y*y,p=s+i,u=Math.sqrt(c-p*p),h=(p*a+u*y)/c,d=(p*y-u*a)/c,f=t.x+h*s,x=t.y+d*s,g=r.x-h*i,b=r.y-d*i;return this.lin(f,x,g,b,Object.assign({ls:"#888",lw:4},e)).proxy(g2.prototype.lin,[f,x,g,b])};g2.prototype.ground=function m(t,o,r){var n,e,l,s,i,a,y,c,p,u,h,d,f=[],x=r&&r.h||4,g=r&&r.pos==="left"?1:-1,b=g2.prototype.ply.itrOf(t,r);e=l=b(n=0);f.push(e);i=b(n=1);y=i.x-l.x;c=i.y-l.y;h=Math.hypot(y,c)||1;a=p={x:y/h,y:c/h};for(s=b(++n);n<b.len;s=b(++n)){y=s.x-i.x;c=s.y-i.y;h=Math.hypot(y,c)||1;u={x:y/h,y:c/h};d=(1-u.x*p.x-u.y*p.y)/(p.y*u.x-p.x*u.y);f.push({x:i.x+g*(x+1)*(d*p.x-p.y),y:i.y+g*(x+1)*(d*p.y+p.x)});p=u;l=i;i=s}if(o){y=e.x-i.x;c=e.y-i.y;h=Math.hypot(y,c)||1;u={x:y/h,y:c/h};d=(1-u.x*p.x-u.y*p.y)/(p.y*u.x-p.x*u.y);f.push({x:i.x+g*(x+1)*(d*p.x-p.y),y:i.y+g*(x+1)*(d*p.y+p.x)});d=(1-a.x*u.x-a.y*u.y)/(u.y*a.x-u.x*a.y);f[0]={x:e.x+g*(x+1)*(-d*a.x-a.y),y:e.y+g*(x+1)*(-d*a.y+a.x)}}else{f[0]={x:e.x-g*(x+1)*a.y,y:e.y+g*(x+1)*a.x};f.push({x:i.x-g*(x+1)*p.y,y:i.y+g*(x+1)*p.x})}return this.beg(Object.assign({x:-.5,y:-.5,ls:"@linkcolor",lw:2},r,{fs:"transparent",lc:"butt",lj:"miter"})).ply(f,o,{ls:"@nodfill2",lw:2*x}).ply(t,o,r).end()};g2.prototype.load=function M(t,o,r){function n(t,o){var r=i.x-s.x,n=i.y-s.y,a=r*r+n*n,y=[],c,p=-o;for(var u=0;u<l;u++)y[u]=((e(u).x-s.x)*r+(e(u).y-s.y)*n)/a;return{next:function(){p+=o;for(var t=0;t<l;t++){c=y[t+1]-y[t];if(c>0&&y[t]<=p&&p<=y[t+1]){var i=(p-y[t])/c;return{value:{p1:{x:s.x+p*r,y:s.y+p*n},p2:{x:e(t).x+i*(e(t+1).x-e(t).x),y:e(t).y+i*(e(t+1).y-e(t).y)}}}}}return{done:true}}}}var e=g2.prototype.ply.itrOf(t),l=e.len,s=e(0),i=e(l-1),a=o<1?o:o/Math.hypot(i.x-s.x,i.y-s.y),y=n(t,a),c;this.ply(t,false,Object.assign({fs:"@linkfill"},r,{ls:"transparent"}));while(!(c=y.next()).done)this.vec(c.value.p2,c.value.p1,r);this.proxy(g2.prototype.ply,[t,false]);return this};g2.State=g2.State||{};g2.State.nodcolor="#333";g2.State.nodfill="#dedede";g2.State.nodfill2="#aeaeae";g2.State.linkcolor="#666";g2.State.linkfill="rgba(200,200,200,0.5)";g2.State.dimcolor="darkslategray";g2.State.solid=[];g2.State.dash=[15,10];g2.State.dot=[4,4];g2.State.dashdot=[25,6.5,2,6.5];g2.State.labelOffset=5;g2.State.labelSignificantDigits=3;g2.symbol=g2.symbol||{};g2.symbol.origin=function(){var t=3.5;return g2().beg({lc:"round",lj:"round",lw:1,fs:"@nodfill"}).p().m(6*t,0).l(0,0).l(0,6*t).stroke().p().m(10*t,0).l(6*t,3/4*t).a(-Math.PI/3,6*t,-3/4*t).z().m(0,10*t).l(3/4*t,6*t).a(Math.PI/3,-3/4*t,6*t).z().drw().cir(0,0,t).end()}();g2.symbol.nod=g2().cir(0,0,4,{ls:"@nodcolor",fs:"@nodfill",lwnosc:true});g2.symbol.dblnod=g2().cir(0,0,6,{ls:"@nodcolor",fs:"@nodfill"}).cir(0,0,3,{ls:"@nodcolor",fs:"@nodfill2",lwnosc:true});g2.symbol.nodfix=g2().style({ls:"@nodcolor",fs:"@nodfill",lwnosc:true}).p().m(-8,-12).l(0,0).l(8,-12).drw({fs:"@nodfill2"}).cir(0,0,4);g2.symbol.dblnodfix=g2().style({ls:"@nodcolor",fs:"@nodfill",lwnosc:true}).p().m(-8,-12).l(0,0).l(8,-12).drw({ls:"@nodcolor",fs:"@nodfill2"}).cir(0,0,6,{ls:"@nodcolor",fs:"@nodfill"}).cir(0,0,3,{ls:"@nodcolor",fs:"@nodfill2"});g2.symbol.nodflt=g2().style({ls:"@nodcolor",fs:"@nodfill",lwnosc:true}).p().m(-8,-12).l(0,0).l(8,-12).z().drw({fs:"@nodfill2"}).cir(0,0,4,{fs:"@nodfill"}).lin(-9,-19,9,-19,{ls:"@nodfill2",lw:5,lwnosc:false}).lin(-9,-15.5,9,-15.5,{ls:"@nodcolor",lw:2,lwnosc:false});g2.symbol.dblnodflt=g2().style({ls:"@nodcolor",fs:"@nodfill2",lwnosc:true}).p().m(-8,-12).l(0,0).l(8,-12).z().drw().cir(0,0,6,{fs:"@nodfill"}).cir(0,0,3).lin(-9,-19,9,-19,{ls:"@nodfill2",lw:5,lwnosc:false}).lin(-9,-15.5,9,-15.5,{lw:2,lwnosc:false});g2.symbol.gnd=g2().cir(0,0,6,{ls:"@nodcolor",fs:"@nodfill",lwnosc:true}).p().m(0,6).a(-Math.PI/2,6,0).l(-6,0).a(Math.PI/2,0,-6).z().fill({fs:"@nodcolor"});g2.symbol.pol=g2().cir(0,0,6,{ls:"@nodcolor",fs:"@nodfill",lwnosc:true}).cir(0,0,2.5,{ls:"@nodcolor",fs:"@nodcolor"});g2.symbol.dot=g2().cir(0,0,1.5,{fs:"@ls",ls:"transparent"});g2.symbol.sqr=g2().rec(-1.5,-1.5,3,3,{fs:"@ls",ls:"transparent"});g2.symbol.tilde=g2().p().m(0,2).a(Math.PI/2,0,0).a(-Math.PI/2,0,-2).stroke({lc:"round",lwnosc:true});g2.symbol.arrow=g2().p().m(0,0).l(-7,-2).a(Math.PI/3,-7,2).z().drw({fs:"@ls",lj:"round",lwnosc:true});g2.symbol.tick=g2().p().m(0,-2).l(0,2).stroke({lc:"round",lwnosc:true});g2.symbol.arrowtick=g2().p().m(0,-2).l(0,2).m(0,0).l(-7,-2).a(Math.PI/3,-7,2).z().drw({lj:"round",lc:"round"});g2.symbol.ifo2pos=g2().style({ls:"@nodcolor",lc:"round",fs:"@ls",lw:1,lwnosc:true}).p().m(0,2).a(-Math.PI/2,0,0).a(Math.PI/2,0,-2).m(6,-6).a(Math.PI/2,6,6).stroke().p().m(3,6).l(3,-2).m(3,-6).l(4,-2).a(-Math.PI/3,2,-2).z().m(7,3).a(-Math.PI/3,8.5,4).l(6,6).z().drw();g2.symbol.ifo2neg=g2().style({ls:"@nodcolor",lj:"miter",fs:"@ls",lw:1,lwnosc:true}).p().m(0,2).a(Math.PI/2,0,0).a(-Math.PI/2,0,-2).m(-6,-6).a(-Math.PI/2,-6,6).stroke().p().m(-3,-6).l(-3,5).m(-3,6).l(-4,3).a(-Math.PI/3,-2,3).z().m(-7,3).a(Math.PI/3,-8.5,4).l(-6,6).z().drw();g2.symbol.ifo3pos=g2().style({ls:"@nodcolor",lc:"round",fs:"@ls",lw:1,lwnosc:true}).p().m(0,2).a(-Math.PI/2,0,0).a(Math.PI/2,0,-2).m(6,-6).a(Math.PI/2,6,6).stroke().p().m(3,6).l(3,-2).m(3,-6).l(4,-2).a(-Math.PI/3,2,-2).z().m(7,3).a(-Math.PI/3,8.5,4).l(6,6).z().m(4,0).l(10,0).m(14,0).l(10,-1).a(Math.PI/3,10,1).z().drw();g2.symbol.ifo3neg=g2().style({ls:"@nodcolor",lc:"round",fs:"@ls",lw:1,lwnosc:true}).p().m(0,2).a(Math.PI/2,0,0).a(-Math.PI/2,0,-2).m(-6,-6).a(-Math.PI/2,-6,6).stroke().p().m(-3,-6).l(-3,5).m(-3,6).l(-4,3).a(-Math.PI/3,-2,3).z().m(-7,3).a(Math.PI/3,-8.5,4).l(-6,6).z().m(-4,0).l(-10,0).m(-14,0).l(-10,-1).a(-Math.PI/3,-10,1).z().drw();g2.prototype.lin.create=function(){var t=Object.create(g2.prototype.lin.prototype);t.constructor.apply(t,arguments[0]);return t};g2.prototype.lin.prototype={constructor:function(t,o,r,n,e){this.x1=t;this.y1=o;this.x2=r;this.y2=n;this.style=e},get dx(){return this.x2-this.x1},get dy(){return this.y2-this.y1},get len(){return Math.hypot(this.dx,this.dy)},p:function(t){var o=t==="beg"?0:t==="end"?1:t+0===t?t:.5,r=this.len;return{x:this.x1+this.dx*o,y:this.y1+this.dy*o,dx:this.dx/r,dy:this.dy/r}}};g2.prototype.rec.create=function(){var t=Object.create(g2.prototype.rec.prototype);t.constructor.apply(t,arguments[0]);return t};g2.prototype.rec.prototype={dir:{c:[0,0,1],e:[1,0,1],ne:[1,1,Math.SQRT2],n:[0,1,1],nw:[-1,1,Math.SQRT2],w:[-1,0,1],sw:[-1,-1,Math.SQRT2],s:[0,-1,1],se:[1,-1,Math.SQRT2]},constructor:function(t,o,r,n,e){this.x=t;this.y=o;this.b=r;this.h=n;this.style=e},get len(){return 2*(this.b+this.h)},p:function(t){var o=this.dir[t||"c"]||this.dir["c"],r=o[0],n=o[1];return{x:this.x+(1+r)*this.b/2,y:this.y+(1+n)*this.h/2,dx:-n/o[2],dy:r/o[2]}}};g2.prototype.cir.create=function(){var t=Object.create(g2.prototype.cir.prototype);t.constructor.apply(t,arguments[0]);return t};g2.prototype.cir.prototype={dir:{c:[0,0],e:[1,0],ne:[Math.SQRT2/2,Math.SQRT2/2],n:[0,1],nw:[-Math.SQRT2/2,Math.SQRT2/2],w:[-1,0],sw:[-Math.SQRT2/2,-Math.SQRT2/2],s:[0,-1],se:[Math.SQRT2/2,-Math.SQRT2/2]},constructor:function(t,o,r,n){this.x=t;this.y=o;this.r=r;this.style=n},get len(){return 2*Math.PI*this.r},p:function(t){var o=t+0===t?[Math.cos(t*2*Math.PI),Math.sin(t*2*Math.PI)]:this.dir[t||"c"],r=o[0],n=o[1];return{x:this.x+r*this.r,y:this.y+n*this.r,dx:-n,dy:r}}};g2.prototype.arc.create=function(){var t=Object.create(g2.prototype.arc.prototype);t.constructor.apply(t,arguments[0]);return t};g2.prototype.arc.prototype={constructor:function(t,o,r,n,e,l){this.x=t;this.y=o;this.r=r;this.w=n;this.dw=e;this.style=l},get len(){return Math.abs(this.r*this.dw)},get angle(){return this.dw/Math.PI*180},p:function(t){var o=t==="beg"?0:t==="end"?1:t==="mid"?.5:t+0===t?t:.5,r=this.w+o*this.dw,n=Math.cos(r),e=Math.sin(r),l=t==="c"?0:this.r;return{x:this.x+l*n,y:this.y+l*e,dx:-e,dy:n}}};g2.prototype.ply.create=function(){var t=Object.create(g2.prototype.ply.prototype);t.constructor.apply(t,arguments[0]);return t};g2.prototype.ply.prototype={constructor:function(t,o,r,n){this.pts=t;this.mode=o;this.itr=r||g2.prototype.ply.itrOf(t,n);this.style=n},get n(){return this.itr.len},get closed(){return this.mode===true},get len(){var t,o,r=this.itr,n=r(0),e,l=this.n,s=this.closed,i=0;for(t=0,o=1;t<(s?l:l-1);t++,o=(t+1)%l){e=r(o);i+=Math.hypot(e.x-n.x,e.y-n.y);n=e}return i},loc:function(t){if(t==="beg")t="#0";else if(t==="end")t="#"+Math.max(this.n-1,0);else if(t===undefined)t=.5;return t},locs:function(t){function o(t,o){var r=[];for(var n=t;n<o;n++)r.push("#"+n);return r}for(var r=0;r<t.length;r++){if(t[r]==="beg")t[r]="#0";else if(t[r]==="end")t[r]="#"+Math.max(this.n-1,0);else if(t[r]==="mid")t=t.splice(r,1)&&t.concat(o(1,Math.max(1,this.n-1)));else if(t[r]==="all")t=t.splice(r,1)&&t.concat(o(0,Math.max(1,this.n)));else if(t===undefined)t[r]=.5}return t},p:function(t){if(typeof t==="string"&&t[0]==="#")return this.pIdx(+t.substr(1));else return this.pPar(t)},pIdx:function(t){var o=this.closed,r=this.n,n=this.itr,e=o?(t-1+r)%r:Math.max(t-1,0),l=o?(t+1)%r:Math.min(t+1,r-1),s=n(e),i=n(t),a=n(l),y=Math.hypot(i.x-s.x,i.y-s.y),c=Math.hypot(a.x-i.x,a.y-i.y),p=(y>Number.EPSILON?(i.x-s.x)/y:0)+(c>Number.EPSILON?(a.x-i.x)/c:0),u=(y>Number.EPSILON?(i.y-s.y)/y:0)+(c>Number.EPSILON?(a.y-i.y)/c:0),h=Math.hypot(p,u);return{x:i.x,y:i.y,dx:h>Number.EPSILON?p/h:0,dy:h>Number.EPSILON?u/h:0}},pPar:function(t){var o,r,n=this.itr,e=n(0),l,s=this.n,i=this.len,a=this.closed,y=0,c,p,u,h,d;if(i>0){t=Math.max(0,Math.min(1,t));h=t*i;for(o=0,r=1;o<=(a?s:s-1);o++,r=(o+1)%s){l=n(r);c=l.x-e.x;p=l.y-e.y;u=Math.hypot(c,p);if(y+u>=h){d=(t-y/i)*i/u;return{x:e.x+d*c,y:e.y+d*p,dx:c/u,dy:p/u}}y+=u;e=l}}return n(0)}};g2.prototype.spline.create=function(){var t=Object.create(g2.prototype.spline.prototype);t.constructor.apply(t,arguments[0]);return t};g2.prototype.spline.prototype={constructor:function(t,o,r){this.pts=t;this.closed=o;this.itr=g2.prototype.ply.itrOf(t,r);this.style=r},get n(){return this.itr.len},get len(){return 1},loc:function(t){if(t==="beg")t="#0";else if(t==="end")t="#"+Math.max(this.n-1,0);return t},locs:function(t){function o(t,o){var r=[];for(var n=t;n<o;n++)r.push("#"+n);return r}for(var r=0;r<t.length;r++){if(t[r]==="beg")t[r]="#0";else if(t[r]==="end")t[r]="#"+Math.max(this.n-1,0);else if(t[r]==="mid")t=t.splice(r,1)&&t.concat(o(1,Math.max(1,this.n-1)));else if(t[r]==="all")t=t.splice(r,1)&&t.concat(o(0,Math.max(1,this.closed?this.n-1:this.n)))}return t},p:function(t){if(typeof t==="string"&&t[0]==="#")return this.pIdx(+t.substr(1));else return this.pIdx(0)},pIdx:function(t){var o=this.itr(t),r,n,e,l;if(this.closed||t!==this.n-1){r=o.x1-o.x;n=o.y1-o.y}else{var s=this.itr(t-1);r=o.x-s.x2;n=o.y-s.y2}e=Math.hypot(r,n);return{x:o.x,y:o.y,dx:e>Number.EPSILON?r/e:0,dy:e>Number.EPSILON?n/e:0}}};g2.prototype.use.create=function(){var t=Object.create(g2.prototype.use.prototype);t.constructor.apply(t,arguments[0]);return t};g2.prototype.use.prototype={dir:g2.prototype.cir.prototype.dir,constructor:function(t,o){this.g=t;this.args=o},get x(){return this.args&&this.args.x||0},get y(){return this.args&&this.args.y||0},get r(){return 5},p:g2.prototype.cir.prototype.p};